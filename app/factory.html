<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="./assets/css/pages/factory.css">
<link rel="stylesheet" href="./assets/css/all.css">
<script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.js' integrity='sha512-YXLGLsQBiwHPHLCAA9npZWhADUsHECjkZ71D1uzT2Hpop82/eLnmFb6b0jo8pK4T0Au0g2FETrRJNblF/46ZzQ==' crossorigin='anonymous'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.js"></script>
<script src="./assets/js/all.js"></script>
<title>factory</title>
</head>

<body>
    <div id="factory">
        <vue-header></vue-header>
        <div class="container containerMain">

            <div class="modal js-modal reportModal" data-modal="1">
                <div class="modal__group">
                    <svg role="button" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 52 52" class="icon modal__close js-close" @click="closeModal">
                                <g transform="translate(0 0.47)">
                                    <line x1="33.493" transform="translate(14.158 13.688) rotate(45)" fill="none" stroke="#522613" stroke-linecap="round" stroke-width="5"/>
                                    <line x1="33.493" transform="translate(37.842 13.688) rotate(135)" fill="none" stroke="#522613" stroke-linecap="round" stroke-width="5"/>
                                </g>
                                </svg>
                    <h2 class="modal__title">
                        新增地址
                    </h2>
                    <p class="modal__content--left">檢舉留言這篇留言的原因?</p>
                    <ul class="modal__textGroup">
                        <li class="modal__textGroupContent"> <input type="radio" name="check" id="bad1"> <label for="bad1">中傷、歧視、謾罵等人身攻擊言論</label> </li>
                        <li class="modal__textGroupContent"> <input type="radio" name="check" id="bad2"> <label for="bad2">包含性騷擾或血腥恐怖等讓人不舒服之內容</label></li>
                        <li class="modal__textGroupContent"> <input type="radio" name="check" id="bad3"> <label for="bad3">文章內容空泛或明顯無意義內容</label> </li>
                        <li class="modal__textGroupContent"> <input type="radio" name="check" id="bad4"> <label for="bad4">涉及宗教、種族歧視或政治對立等言論</label> </li>
                        <li class="modal__textGroupContent"> <input type="radio" name="check" id="bad5"> <label for="bad5">留言內容空泛或無關作品內容</label> </li>
                    </ul>
                    <button class="btn btn--ghost">取消</button>
                    <button class="btn ml-5 finishReport" @click="openReportSuccessModal">完成</button>
                </div>
            </div>

                <div class="intro">
                    <div class="intro_pic col-7 col-lg-4 col-sm-3">
                        <img src="./assets/img/pic/model.png" class="model">
                        <div class="lable">
                            <p class="h4">NT$</p>
                            <h2 class="emphasis">300</h2>
                            <p class="h4">起</p>
                        </div>
                    </div>
                    <div class="intro_content col-5 col-lg-2 col-sm-4">
                        <h2 class="emphasis intro_content_title">打造自己的車</h2>
                        <p class="h3 intro_content_text">在車車工廠，<br> 我們提供各種車款、烤漆顏色和不同配備，
                            <br> 您可以盡情揮灑創意，創作屬於自己的超酷客製車。
                        </p>
                        <button class="btn make" @click="make">開始製作</button>
                    </div>
                </div>

                <!-- 製作車子的區域 -->
                <div class="makeCar col-12 col-lg-6 col-sm-4">
                    <div class="mainArea">
                        <canvas id="canvas" class="mainAreaPic canvas" width="400" height="200" style="border: 1px solid #ccc;"></canvas>
                        <canvas id="canvas" class="accessoryPic1 canvasA1" width="400" height="200" style="border: 1px solid #ccc;"></canvas>
                        <canvas id="canvas" class="accessoryPic2 canvasA2" width="400" height="200" style="border: 1px solid #ccc;"></canvas>
                        <canvas id="canvas" class="accessoryPic3 canvasA3" width="400" height="200" style="border: 1px solid #ccc;"></canvas>
                    </div>
                    <div id="progressBar" class="progressBar">

                        @@include('./pages/FactoryPage/FactoryProgress.html')
                    </div>


                    <div class="selectAreaOut">
                        <div class="selectBtn">
                            <div class="selectAreaOut-previous" @click="moveLeft"><img src="./assets/img/icon/icon-left.svg" alt=""></div>
                            <div class="selectAreaOut-next" @click="moveRight"><img src="./assets/img/icon/icon-right.svg" alt=""></div>
                        </div>

                        <ul class="selectArea col-12 col-lg-6 col-sm-4" style="left: 0px;">
                            <!-- 車型 -->
                            <div class="shapeCards">
                                <li class="shapeCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/shape01.png" class="shape">
                                    </div>

                                    <p class="makeCar-name">Audi R8小客車</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectShape" @click="getShapeIndex">選擇此車型</button>
                                </li>

                                <li class="shapeCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/shape02.png" class="shape">
                                    </div>
                                    <p class="makeCar-name">Audi R8小客車</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectShape" @click="getShapeIndex">選擇此車型</button>
                                </li>

                                <li class="shapeCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/shape03.png" class="shape">
                                    </div>
                                    <p class="makeCar-name">Audi R8小客車</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectShape" @click="getShapeIndex">選擇此車型</button>
                                </li>

                                <li class="shapeCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/shape03.png" class="shape">
                                    </div>
                                    <p class="makeCar-name">Audi R8小客車</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectShape" @click="getShapeIndex">選擇此車型</button>
                                </li>
                            </div>

                            <!-- 顏色 -->
                            <div class="colorCards">
                                <li class="colorCard col-3 col-lg-3 col-sm-3">
                                    <div class="color">
                                        <div class="white"></div>
                                    </div>
                                    <p class="makeCar-name">白</p>
                                    <p class="makeCar-price">NT$ 50</p>
                                    <button class="btn btn--fluid btn--outline selectColor selectWhite">選擇烤漆</button>
                                </li>

                                <li class="colorCard col-3 col-lg-3 col-sm-3">
                                    <div class="color">
                                        <div class="red"></div>
                                    </div>
                                    <p class="makeCar-name">紅</p>
                                    <p class="makeCar-price">NT$ 50</p>
                                    <button class="btn btn--fluid btn--outline selectColor selectRed">選擇此烤漆</button>
                                </li>

                                <li class="colorCard col-3 col-lg-3 col-sm-3">
                                    <div class="color ">
                                        <div class="orange"></div>
                                    </div>
                                    <p class="makeCar-name">橙</p>
                                    <p class="makeCar-price">NT$ 50</p>
                                    <button class="btn btn--fluid btn--outline selectColor selectOrange">選擇此烤漆</button>
                                </li>

                                <li class="colorCard col-3 col-lg-3 col-sm-3">
                                    <div class="color ">
                                        <div class="yellow"></div>
                                    </div>
                                    <p class="makeCar-name">黃</p>
                                    <p class="makeCar-price">NT$ 70</p>
                                    <button class="btn btn--fluid btn--outline selectColor selectYellow">選擇此烤漆</button>
                                </li>

                                <li class="colorCard col-3 col-lg-3 col-sm-3">
                                    <div class="color ">
                                        <div class="purple"></div>
                                    </div>
                                    <p class="makeCar-name">紫</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectColor selectPurple">選擇此烤漆</button>
                                </li>
                            </div>


                            <!-- 輪子 -->
                            <div class="tireCards">
                                <li class="tireCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/tire01.png" class="tire">
                                    </div>
                                    <p class="makeCar-name">酷炫款輪子</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectTire selectT1">選擇此車輪</button>
                                </li>

                                <li class="tireCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/tire02.png" class="tire">
                                    </div>
                                    <p class="makeCar-name">懷舊款輪子</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectTire selectT2">選擇此車輪</button>
                                </li>

                                <li class="tireCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/tire03.png" class="tire">
                                    </div>
                                    <p class="makeCar-name">經典款輪子</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectTire selectT3">選擇此車輪</button>
                                </li>

                                <li class="tireCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/tire04.png" class="tire">
                                    </div>
                                    <p class="makeCar-name">時尚款輪子</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectTire selectT4">選擇此車輪</button>
                                </li>
                            </div>


                            <!-- 配件 -->
                            <div class="accessoryCards">
                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory1.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">圓形燈飾</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory  selectA1">新增此配件</button>
                                </li>

                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory2.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">方形藍色燈飾</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory selectA2">新增此配件</button>
                                </li>

                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory3.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">紅藍色燈飾</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory selectA3">新增此配件</button>
                                </li>

                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory4.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">可愛動物車貼</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory selectA4">新增此配件</button>
                                </li>

                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory5.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">雙馬車貼</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory selectA5">新增此配件</button>
                                </li>

                                <li class="accessoryCard col-3 col-lg-3 col-sm-3">
                                    <div class="cardOut">
                                        <img src="./assets/img/pic/accessory6.png" class="accessory">
                                    </div>
                                    <p class="makeCar-name">白色尾翼</p>
                                    <p class="makeCar-price">NT$ 100</p>
                                    <button class="btn btn--fluid btn--outline selectAccessory selectA6">選擇此配件</button>
                                </li>
                            </div>
                        </ul>
                    </div>

                    <div class="tipArea">
                        <div class="tipArea_left col-6 col-sm-4">
                            <button class="btn btn--outline previousStep invisible" @click="toPreviousStep"><img src="./assets/img/icon/icon-double-left.svg" class="icon">上一步</button>
                        </div>
                        <div class="tipArea_right col-6 col-sm-4">
                            <div class="tipPrice">
                                <p class="h4">總金額</p>
                                <p class="totalPrice">NT$ 0</p>
                            </div>
                            <div class="pleaseSelect">請先選擇車款才能進行下一步喔</div>
                            <button class="btn btn--disabled nextStep" @click="toNextStep">下一步</button>
                        </div>
                    </div>


                    <div class="giveName">
                        <div class="giveName_left">
                            <p class="description">幫您的作品取個名字</p>
                            <input type="text" class="typeWorkName">
                            <div class="nameTip">
                                <p>餘20字</p>
                                <button class="btn btn--link randomName h5">隨機取名</button>
                            </div>

                            <input type="checkbox" name="" value="">公開此作品

                            <p class="description">使用者暱稱</p>
                            <input type="text" class="typeNickName">
                            <p class="notice">使用者暱稱將會被引用於網站相關留言及連結</p>
                        </div>
                        <div class="giveName_right">
                            <p class="description">描述您的創作靈感</p>
                            <textarea name="" id="" cols="50" rows="10" placeholder="這是我的第一個作品" class="typeInspiration"></textarea>
                            <p>餘100字</p>
                        </div>
                    </div>
                </div>

                <div class="workBar col-12 col-lg-6 col-sm-4">
                    <div class="workBar_left">
                        <button class="workButton h2 works" @click="showWorks">大家的作品</button>
                        <button class="workButton h2 myworks" @click="showMywork">我的作品</button>
                    </div>
                    <div class="workBar_right">
                        <p class="h4 mr-4">排序</p>
                        <select name="" id="" class="filter h4" @click="sort">
                            <option class="goodFirst">按讚數多到少</option>
                            <option class="newFirst">按作品新到舊</option>
                            <option class="OldFirst">按作品舊到新</option>
                        </select>
                    </div>

                </div>

                <div>
                    <ul class="othersWorks grid">
                        <work-card :img="'./assets/img/pic/model01.png'" :good-num="24" :post-time="15"></work-card>
                        <work-card2></work-card2>                        
                        <work-card :img="'./assets/img/pic/model02.png'" :good-num="15"></work-card >
                        <work-card :img="'./assets/img/pic/model03.png'" :good-num="13" :post-time="7"></work-card >
                        <work-card :img="'./assets/img/pic/model04.png'" :good-num="5"></work-card >
                        <work-card :img="'./assets/img/pic/model05.png'" :post-time="26"></work-card>

                        <!-- ajax -->
                     </ul>

                    <div class="mywork" id="mywork">
                        <empty-state></empty-state>
                    </div>
                </div>
        </div>
        @@include('./components/Footer.html')
        
    </div>


    <div id="factoryModal">
        @@include('./pages/FactoryPage/FactoryModal.html')
        @@include('./pages/FactoryPage/reportSuccessModal.html')

    </div>

    @@include('./components/VueHeader.html')

    <script>
        //全域component

        //emptyState
        Vue.component('empty-state', {
            data(){
              return{
                description: '目前沒有作品',
                description2: '快去完成你的作品吧',
                btnDes: '開始製作',
                url: "window.location='../../dist/factory.html'"
              };
            },
            template: `
                <div class="container pt-0">
                    <div class="emptyState row pt-25">
                        <div class="empty--left col-6 col-lg-3 col-sm-2">
                            <img src="./assets/img/illust/illust-empty.png" alt="">
                        </div>
                        <div class="empty--right col-6 col-lg-3 col-sm-2">
                            <p class="mb-6 h4" v-bind:details="description">{{description}}</p>
                            <p class="mb-12 h4"  v-bind:details="description2">{{description2}}</p>
                            <button class="btn" v-bind:btnText="btnDes" :onclick=url>{{btnDes}}</button>
                        </div>
                    </div>
                    <ul class="putMywork"></ul>
                </div>`,
            props: ['details', 'details2', 'btn-text']
        });

        //大家的作品、我的作品的卡片
        Vue.component(('work-card'),{
            props:{
                img:{
                    default:"./assets/img/pic/model04.png",
                    type:String
                },
                goodNum:{
                    default:0,
                    type:Number
                },
                commentNum:{
                    default:1,
                    type:Number
                },
                postTime:{
                    default:4,
                    type:Number
                },
            },
            data(){
                return{
                    count1: 0,
                    count2: 0,
                    is_icon_color:false,
                    goodNum_plus: this.goodNum,
                    commentNum_plus: this.commentNum,
                    
                }
            },
            template: `<li class="work grid-item grid-item--height1 col
            -4 col-lg-2 col-sm-4">
                            <div class="work_pic" @click="openWorkModal">
                                <img :src="img" class="">
                            </div>

                            <div class="work_author">
                                <img src="./assets/img/pic/userPic.png" class="userPic">
                                <div class="userContent">
                                    <p class="userName h6">矛盾的小女子</p>
                                    <h2 class="workName h4">天栗鼠計程車</h2>
                                    <p class="userContent h5">這是一隻天栗鼠，這不是一隻天栗鼠，這到底是不是一隻天栗鼠？</p>
                                    <div class="other">
                                        <p class="postTime mainTime h6" :v-text="postTime">{{postTime}}小時前</p>
                                        <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                    </div>
                                </div>
                            </div>

                            <div class="workInfo">
                                <div class="workInfo_good">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon goodIcon" @mouseover="coloredIcon" @mouseout="noColorIcon" @click="addGoodNum">
                                        <g transform="translate(-729 -275)">
                                          <path d="M14.513,37.47l10.1.209c4.043,0,8.616-5.286,9.752-7.915,0,0,3.514-7.2,2.541-12.055-1.78-3.084-4.026-2.219-13.046-2.219l1.545-7,.052-.515a2.489,2.489,0,0,0-.713-1.743L23.013,4.5,12.194,15.43a3.3,3.3,0,0,0-.944,2.327V34.241A3.237,3.237,0,0,0,14.513,37.47Z" transform="translate(735.366 280.5)" fill="none" stroke="#E59807" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" :class="{'pin--secondary':is_icon_color === true}"/>
                                          <path d="M3.375,15.75H8.87V34.982H3.375Z" transform="translate(733.625 282.987)" fill="#E59807" :class="{'pin--secondary':is_icon_color === true}"/>
                                        </g>
                                    </svg>
                                    <p  class="num h3" :v-text="goodNum">{{goodNum_plus}}</p>
                                </div>
                                <div class="workInfo_reply">                                   
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon commentIcon">
                                        <g transform="translate(-396.868 -362.313)">
                                          <path  d="M413.686,374.254c-8.888,0-16.12,6.165-16.12,13.743a12.384,12.384,0,0,0,3.545,8.634l0,0,0,0a5.214,5.214,0,0,1,1.473,3.662,6.52,6.52,0,0,1,2-.328,5.51,5.51,0,0,1,2.032.38h.006a18.861,18.861,0,0,0,7.058,1.389c8.888,0,16.12-6.165,16.12-13.745s-7.232-13.743-16.12-13.743m0-4.666c11.479,0,20.786,8.242,20.786,18.41s-9.307,18.411-20.786,18.411a23.417,23.417,0,0,1-8.774-1.716.893.893,0,0,0-.322-.055c-1.569,0-4.921,3.126-6.8,3.126a1.16,1.16,0,0,1-.7-.209c-1.973-1.66,1.569-6.761.7-7.646A17.091,17.091,0,0,1,392.9,388C392.9,377.83,402.206,369.588,413.686,369.588Z" transform="translate(8.967 -0.274)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(413 386)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(420 386)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(427 386)" fill="#E59807"/>
                                        </g>
                                    </svg>
                                    <p  class="num h3">{{commentNum_plus}}</p>
                                </div>
                            </div>

                            <div class="work_reply">
                                <div class="userContext">
                                    <img src="./assets/img/pic/userPic02.png" class="userPic">
                                    <div class="userContext_top">
                                        <p class="userName h6">天婦羅好好吃</p>
                                        <p class="userContent h5">天婦羅好好吃</p>
                                        <div class="other">
                                            <p class="postTime h6">3小時前</p>
                                            <div>                                
                                                <button class="btn btn--link mr-4 h5 replyComment" @click="openSubTextarea">回覆</button>
                                                <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="typeSubReply">
                                    <img src="./assets/img/pic/userPic.png" class="userPic replyerPic">
    
                                    <div class="typeReply_right">
                                        <p class="replyerName">沾醬大師</p>
                                        <textarea name="" id="" cols="24" rows="5" placeholder="讚美這個作品，或發表看法。" class="textarea"></textarea>
                                        <div class="other">
                                            <p class="textCount"></p>
                                            <button class="btn btn--small h5 subComment" @click="postSubComment">回覆</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="moreReply hiddenMR" @click="openMoreReply">
                                <p class="h5 moreReplyWord text-coffee">1則回覆</p>
                                <img src="./assets/img/icon/icon-down.svg" class="icon toggleIcon1">
                            </div>
                            <div class="readMore" @click="openReadMore">
                                <p class="h5 readMoreWord text-coffee">閱讀更多</p>
                                <img src="./assets/img/icon/icon-down.svg" class="icon toggleIcon2">
                            </div>

                            <div class="typeReply">
                                <img src="./assets/img/pic/userPic.png" class="userPic replyerPic">

                                <div class="typeReply_right">
                                    <p class="replyerName">沾醬大師</p>
                                    <textarea name="" id="" cols="24" rows="5" placeholder="讚美這個作品，或發表看法。" class="textarea"></textarea>
                                    <div class="other">
                                        <p class="textCount"></p>
                                        <button class="btn btn--small h5 comment" @click="addBorder">留言</button>
                                    </div>
                                </div>
                            </div>
                        </li>`,
            methods: {
                addBorder(e){ //按留言若未輸入字的話變紅框、留言
                    let textLength = $(e.target).parent().parent().children('.textarea').val().length;
                    let commentContent = $(e.target).parent().parent().children('.textarea').val();
                    let replyerPic = $(e.target).parent().parent().parent().children('.replyerPic').attr('src');
                    console.log(replyerPic)
                    let replyerName = $(e.target).parent().parent().children('.replyerName').text();
                    console.log(replyerName)
                    // console.log(replyerName)
                    if (textLength < 1) {
                        // console.log('no text')
                        $(e.target).parent().parent().children('.textarea').css({"border": "1px solid red"})
                    } else {
                        // console.log('ok')
                        $(e.target).parent().parent().children('.textarea').css({"border": "1px solid #000"})

                        $(e.target).parent().parent().parent().parent().children(`.readMore`).before(`<div class="work_reply hiddenReply">
                                <div class="userContext">
                                    <img src="${replyerPic}"  class="userPic">
                                    <div class="userContext_top">
                                        <p class="userName h6">${replyerName}</p>
                                        <p class="userContent h5">${commentContent}</p>
                                        <div class="other--type2">
                                            <p class="postTime h6">3小時前</p>
                                            <div>               
                                                <button class="btn btn--link mr-4 h5 replyComment replyComment">回覆</button>
                                                <button class="btn btn--link mr-4 h5 replyComment report" @click="openReportModal">檢舉</button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>`)
                        
                        $(e.target).parent().parent().children('.textarea').val('');
                        $(e.target).parent().children('.textCount').text(`餘${textMax}字`);

                        this.commentNum_plus += 1;
                    }   
                },
                coloredIcon(e){
                    this.is_icon_color = true

                    // console.log('變色囉')
                    // $(e.target).children('g').children('path').addClass('pin--secondary')            
                },
                noColorIcon(e){
                    this.is_icon_color = false
                    // console.log('變回去囉')
                    // $(e.target).children('g').children('path').removeClass('pin--secondary')  
                },
                openSubTextarea(e){
                    console.log(this.$el)
                    $(this.$el).children('.work_reply').children('.typeSubReply').slideToggle();
                    $(this.$el).children('.work_reply').children('.typeSubReply').css({"display":"flex"});
                },
                openReportModal(){
                    $('.container .modal').addClass('modal-active');
                    // console.log('report!')
                },
                addGoodNum(e){
                    this.goodNum_plus += 1;

                    // ajax
                },
                openWorkModal(){ //進入彈窗、後面固定不給滾動
                        $('.mask').css({"display": "block"});
                        $('#factoryModal').css({"position": "fixed"});
                        $('#factoryModal').css({"z-index": "2010"});

               },
               openMoreReply(e){
                    $(this.$el).children('.work_reply').children('.hiddenSubReply').slideToggle();
                    $(this.$el).children('.work_reply').children('.hiddenSubReply').css({"display": "flex",});
                    this.count1 += 1;
                    // console.log(count1);
                
                    if (this.count1 % 2 == 1) {
                        console.log(this.count1)
                        $(this.$el).children('.moreReply').children('.moreReplyWord').text('關閉子回覆');
                    
                        $(this.$el).children('.moreReply').children('.toggleIcon1').css({
                            "transform": "rotate(180deg)",
                        })
                    } else {
                        console.log(this.count1)

                        $(this.$el).children('.moreReply').children('.moreReplyWord').text('1則回覆');
                    
                        $(this.$el).children('.moreReply').children('.toggleIcon1').css({
                            "transform": "rotate(0deg)",
                        })
                    }
               },
               openReadMore(){
                    $(this.$el).children('.hiddenReply').slideToggle();
                    $(this.$el).children('.hiddenReply').css({"display": "flex"});

                    this.count2 += 1;
                    // console.log(count2);

                    if (this.count2 % 2 == 1) {
                        $(this.$el).children('.readMore').children('.readMoreWord').text('關閉更多');
                        $(this.$el).children('.readMore').children('.toggleIcon2').css({
                            "transform": "rotate(180deg)",
                        })
                    } else {
                        $(this.$el).children('.readMore').children('.readMoreWord').text('閱讀更多');
                        $(this.$el).children('.readMore').children('.toggleIcon2').css({
                            "transform": "rotate(0deg)",
                        })
                    }
               },
               postSubComment(e){ //PO回覆的回覆
                   console.log('subComment is clicked')
                   let commentContentL = $(e.target).parent().parent().children('.textarea').val().length;
                   let commentContent = $(e.target).parent().parent().children('.textarea').val();
                   console.log(commentContentL)
                   
                   let replyerPic = $(e.target).parent().parent().parent().children('.replyerPic').attr('src');
                   console.log(replyerPic)
                  
                   let replyerName = $(e.target).parent().parent().children('.replyerName').text();
                   console.log(replyerName)
                   
                   if (commentContentL > 0) {
                    $(e.target).parent().parent().parent().parent().children('.userContext').after(`
                            <div class="subUserContext hiddenSubReply">
                                <img src="${replyerPic}"  class="userPic">
                                <div class="userContext_top">
                                    <p class="userName h6">${replyerName}</p>
                                    <p class="userContent h5">${commentContent}</p>
                                    <div class="other">
                                        <p class="postTime h6">3小時前</p>
                                        <div>                                
                                            <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `)
                        
                    $(e.target).parent().parent().children('.textarea').val('');
                    $(e.target).parent().children('.textCount').text(`餘${textMax}字`);
                   }

                   //PO完後關掉回覆的回覆
                   $('.typeSubReply').css({"display":"none"})
                   
                   //PO完後出現「X則回覆」
                   $(e.target).parent().parent().parent().parent().parent().children('.hiddenMR').css({"display":"flex"})
               },
            },
        })

        Vue.component(('work-card2'),{
            props:{
                img:{
                    default:"./assets/img/pic/model01.png",
                    type:String
                },
                goodNum:{
                    default:18,
                    type:Number
                },
                commentNum:{
                    default:2,
                    type:Number
                },
                postTime:{
                    default:1,
                    type:Number
                }
            },
            data(){
                return{
                    count1: 0,
                    count2: 0,
                    is_icon_color:false,
                    goodNum_plus: this.goodNum,
                    commentNum_plus: this.commentNum,
                }
            },
            template: `<li class="work grid-item grid-item--height2 col-4 col-lg-2 col-sm-4">
                            <div class="work_pic">
                                <img src="./assets/img/pic/model03.png" class="model">
                            </div>

                            <div class="work_author">
                                <img src="./assets/img/pic/userPic.png" class="userPic">
                                <div class="userContent">
                                    <p class="userName h6">矛盾的小女子</p>
                                    <h2 class="workName h4">天栗鼠計程車</h2>
                                    <p class="userContent h5">這是一隻天栗鼠，這不是一隻天栗鼠，這到底是不是一隻天栗鼠？</p>
                                    <div class="other">
                                        <p class="postTime mainTime h6" :v-text="postTime">{{postTime}}小時前</p>
                                        <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                    </div>
                                </div>
                            </div>

                            <div class="workInfo">
                                <div class="workInfo_good">
                                    
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon goodIcon" @click="addGoodNum" @mouseover="coloredIcon" @mouseout="noColorIcon">
                                        <g transform="translate(-729 -275)">
                                          <path d="M14.513,37.47l10.1.209c4.043,0,8.616-5.286,9.752-7.915,0,0,3.514-7.2,2.541-12.055-1.78-3.084-4.026-2.219-13.046-2.219l1.545-7,.052-.515a2.489,2.489,0,0,0-.713-1.743L23.013,4.5,12.194,15.43a3.3,3.3,0,0,0-.944,2.327V34.241A3.237,3.237,0,0,0,14.513,37.47Z" transform="translate(735.366 280.5)" fill="none" stroke="#E59807" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" :class="{'pin--secondary':is_icon_color === true}"/>
                                          <path d="M3.375,15.75H8.87V34.982H3.375Z" transform="translate(733.625 282.987)" fill="#E59807" :class="{'pin--secondary':is_icon_color === true}"/>
                                        </g>
                                    </svg>
                                    <p  class="num h3">{{goodNum_plus}}</p>
                                </div>
                                <div class="workInfo_reply">
                                    
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon commentIcon">
                                        <g transform="translate(-396.868 -362.313)">
                                          <path  d="M413.686,374.254c-8.888,0-16.12,6.165-16.12,13.743a12.384,12.384,0,0,0,3.545,8.634l0,0,0,0a5.214,5.214,0,0,1,1.473,3.662,6.52,6.52,0,0,1,2-.328,5.51,5.51,0,0,1,2.032.38h.006a18.861,18.861,0,0,0,7.058,1.389c8.888,0,16.12-6.165,16.12-13.745s-7.232-13.743-16.12-13.743m0-4.666c11.479,0,20.786,8.242,20.786,18.41s-9.307,18.411-20.786,18.411a23.417,23.417,0,0,1-8.774-1.716.893.893,0,0,0-.322-.055c-1.569,0-4.921,3.126-6.8,3.126a1.16,1.16,0,0,1-.7-.209c-1.973-1.66,1.569-6.761.7-7.646A17.091,17.091,0,0,1,392.9,388C392.9,377.83,402.206,369.588,413.686,369.588Z" transform="translate(8.967 -0.274)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(413 386)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(420 386)" fill="#E59807"/>
                                          <circle cx="2.4" cy="2.4" r="2.4" transform="translate(427 386)" fill="#E59807"/>
                                        </g>
                                    </svg>
                                    <p  class="num h3">{{commentNum_plus}}</p>
                                </div>
                            </div>

                            <div class="work_reply">
                                <div class="userContext">
                                    <img src="./assets/img/pic/userPic02.png" class="userPic">
                                    <div class="userContext_top">
                                        <p class="userName h6">天婦羅好好吃</p>
                                        <p class="userContent h5">天婦羅好好吃</p>
                                        <div class="other">
                                            <p class="postTime h6">30分鐘前</p>
                                            <div>                                
                                                <button class="btn btn--link mr-4 h5 replyComment">回覆</button>
                                                <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="subUserContext">
                                    <img src="./assets/img/pic/userPic03.png" class="userPic--small">
                                    <div class="userContext_top">
                                        <p class="userName h6">天婦羅不好吃</p>
                                        <p class="userContent h5">超油</p>
                                        <div class="other">
                                            <p class="postTime h6">3小時前</p>
                                            <div>                                
                                                <button class="btn btn--link mr-4 h5 replyComment">回覆</button>
                                                <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="subUserContext hiddenSubReply">
                                    <img src="./assets/img/pic/userPic03.png" class="userPic--small">
                                    <div class="userContext_top">
                                        <p class="userName h6">油炸退散</p>
                                        <p class="userContent h5">明明就不好吃</p>
                                        <div class="other">
                                            <p class="postTime h6">3小時前</p>
                                            <div>                                
                                                
                                                <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="moreReply" @click="openMoreReply">
                                <p class="h5 moreReplyWord text-coffee">1則回覆</p>
                                <img src="./assets/img/icon/icon-down.svg" class="icon toggleIcon1">
                            </div>

                            <div class="work_reply hiddenReply">
                                <div class="userContext">
                                    <img src="./assets/img/pic/userPic02.png" class="userPic">
                                    <div class="userContext_top">
                                        <p class="userName h6">天婦羅好好吃</p>
                                        <p class="userContent h5">天婦羅好好吃</p>
                                        <div class="other--type2">
                                            <p class="postTime h6">3小時前</p>
                                            <div>                                
                                                <button class="btn btn--link mr-4 h5 replyComment">回覆</button>
                                                <button class="btn btn--link report h5" @click="openReportModal">檢舉</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="readMore" @click="openReadMore">
                                <p class="h5 readMoreWord text-coffee">閱讀更多</p>
                                <img src="./assets/img/icon/icon-down.svg" class="icon toggleIcon2">
                            </div>
                            <div class="typeReply">
                                <img src="./assets/img/pic/userPic.png" class="userPic replyerPic">

                                <div class="typeReply_right">
                                    <p class="replyerName">沾醬大師</p>
                                    <textarea name="" id="" cols="24" rows="5" placeholder="讚美這個作品，或發表看法。" class="textarea"></textarea>
                                    <div class="other">
                                        <p class="textCount"></p>
                                        <button class="btn btn--small h5 comment" @click="addBorder">留言</button>
                                    </div>
                                </div>
                            </div>
                        </li>`,
                        methods: {
                addBorder(e){ //按留言若未輸入字的話變紅框  //第736有問題
                    let textLength = $(e.target).parent().parent().children('.textarea').val().length;
                    let commentContent = $(e.target).parent().parent().children('.textarea').val();
                    let replyerPic = $(e.target).parent().parent().parent().children('.replyerPic').attr('src');
                    console.log(replyerPic)
                    let replyerName = $(e.target).parent().parent().children('.replyerName').text();
                    console.log(replyerName)
                    // console.log(replyerName)
                    if (textLength < 1) {
                        // console.log('no text')
                        $(e.target).parent().parent().children('.textarea').css({"border": "1px solid red"})
                    } else {
                        // console.log('ok')
                        $(e.target).parent().parent().children('.textarea').css({"border": "1px solid #000"})

                        $(e.target).parent().parent().parent().parent().children(`.readMore`).before(`<div class="work_reply hiddenReply">
                                <div class="userContext">
                                    <img src="${replyerPic}"  class="userPic">
                                    <div class="userContext_top">
                                        <p class="userName h6">${replyerName}</p>
                                        <p class="userContent h5">${commentContent}</p>
                                        <div class="other">
                                            <p class="postTime h6">3小時前</p>
                                            <div>                                
                                                <button class="btn btn--link mr-4 h5 replyComment" @click="openReportModal">檢舉</button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>`)
                        
                        $(e.target).parent().parent().children('.textarea').val('');
                        $(e.target).parent().children('.textCount').text(`餘${textMax}字`);

                        this.commentNum_plus += 1;
                    }   
                },
                coloredIcon(e){
                    this.is_icon_color = true   
                },
                noColorIcon(e){
                    this.is_icon_color = false
                },
                openSubTextarea(e){
                    
                    $(this.$el).children('.typeSubReply').slideToggle();
                    $(this.$el).children('.typeSubReply').css({"display":"flex"});
                },
                openReportModal(){
                    $('.containerMain .modal').addClass('modal-active');
                },
                addGoodNum(e){
                    this.goodNum_plus += 1;

                    // ajax//這裡開始
                },
                openMoreReply(){
                    $(this.$el).children('.work_reply').children('.hiddenSubReply').slideToggle();
                    $(this.$el).children('.work_reply').children('.hiddenSubReply').css({"display": "flex",});
                    this.count1 += 1;
                    // console.log(count1);
                
                    if (this.count1 % 2 == 1) {
                        console.log(this.count1)
                        $(this.$el).children('.moreReply').children('.moreReplyWord').text('關閉子回覆');
                    
                        $(this.$el).children('.moreReply').children('.toggleIcon1').css({
                            "transform": "rotate(180deg)",
                        })
                    } else {
                        console.log(this.count1)

                        $(this.$el).children('.moreReply').children('.moreReplyWord').text('1則回覆');
                    
                        $(this.$el).children('.moreReply').children('.toggleIcon1').css({
                            "transform": "rotate(0deg)",
                        })
                    }
               }
               ,openReadMore(){
                    $(this.$el).children('.hiddenReply').slideToggle();
                    $(this.$el).children('.hiddenReply').css({"display": "flex"});

                    this.count2 += 1;
                    // console.log(count2);

                    if (this.count2 % 2 == 1) {
                        $(this.$el).children('.readMore').children('.readMoreWord').text('關閉更多');
                        $(this.$el).children('.readMore').children('.toggleIcon2').css({
                            "transform": "rotate(180deg)",
                        })
                    } else {
                        $(this.$el).children('.readMore').children('.readMoreWord').text('閱讀更多');
                        $(this.$el).children('.readMore').children('.toggleIcon2').css({
                            "transform": "rotate(0deg)",
                        })
                    }
               }
                
            },
        })

        const vm1 = new Vue({ //主體
            el: '#factory',
            data:{
                countStep: 0,
                countR: 0,
                countL: 0,
                docW: $(document).width(),
                shapeIndex:-1,
                circleIndex: -1,
            },
            props:{

            },
            methods: {
                openReportSuccessModal(){ //出現檢舉成功的彈窗
                    $('.reportSuccessModal').addClass('modal-active')
                },
                showWorks(e){ //點選大家的作品時會標示在哪裡，大家作品會出現、我的作品會隱藏
                    $(e.target).css({"background": "linear-gradient(transparent 60%, #FADD61 60%)"})

                    $('.workButton').not(e.target).css({"background": "none"})

                    $('.othersWorks').css({"display": "flex"})
                    $('.mywork').css({"display": "none"})
                },
                showMywork(e){ //點選我的作品時會標示在哪裡，我的作品會出現、大家作品會隱藏
                    $(e.target).css({"background": "linear-gradient(transparent 60%, #FADD61 60%)"})

                    $('.workButton').not(e.target).css({"background": "none"})

                    $('.othersWorks').css({"display": "none"})
                    $('.mywork').css({"display": "block"})
                },
                make(e){ //點開始製作後出現製作區域、順便清空整個canvas
                    $('.previousStep').addClass('invisible')

                    $('.progressBar').css({"display": "block"})

                    $('.circle:first').css({"background-color": "#E59807"})

                    $('.intro').css({"display": "none"})

                    $('.makeCar').css({"display": "block"})

                    console.log('清空空')
                    context.clearRect(0, 0, 400, 200)
                    contextA1.clearRect(0, 0, 400, 200)
                    contextA2.clearRect(0, 0, 400, 200)
                    contextA3.clearRect(0, 0, 400, 200)
                    $(e.target).removeClass('finish')
                },
                closeModal(){ //關掉彈窗
                    // console.log('關掉')
                    $('.modal').removeClass('modal-active');
                },
                toNextStep(){ //點下一步進到下一個步驟、最後一步時生成base64
                    console.log("nextStep is clicked! countStep: "+ this.countStep)
                    console.log(this.docW)
                
                    if ($('.nextStep').hasClass('btn--disabled')) {
                    
                        $('.pleaseSelect').css({"display": "block"})
                    
                        setTimeout(() => {
                            $('.pleaseSelect').css({"display": "none"})
                        }, 1000);
                    } else {
                        $('.previousStep').removeClass('invisible')
                    
                        this.countStep += 1;
                        $('.shapeCard').css({"display": "none"})
                    
                        if (this.countStep % 5 == 1) {
                            console.log(this.countStep)
                            $('.nextStep').addClass('btn--disabled')
                        
                            //進入選顏色
                            $('.colorCards').css({"display": "flex"})
                            $('.colorCard').css({"display": "block"})
                        
                            //提醒內容變更
                            $('.pleaseSelect').text('請先選擇烤漆才能進入下一步喔')
                        
                            //進度條、圓圈變色
                            $('.content:nth-child(2) .circle').addClass('circle--able')
                            $('.content:nth-child(2) .circle').addClass('circle--active')
                        
                            if (this.docW > 1003) {
                                $('.bar-front').width(240)
                            } else if (this.docW <= 1003) {
                                $('.bar-front').width(220)
                            }
                        
                        } else if (this.countStep % 5  == 2) {
                            console.log(this.countStep)
                        
                            $('.nextStep').addClass('btn--disabled')
                        
                            //進入選輪子
                            $('.colorCard').css({"display": "none"})
                        
                            $('.tireCards').css({"display": "flex"})
                            $('.tireCard').css({"display": "block"})
                        
                            //提醒內容變更
                            $('.pleaseSelect').text('請先選擇輪胎才能進入下一步喔')
                        
                            //進度條變色
                            $('.content:nth-child(3) .circle').addClass('circle--able')
                            $('.content:nth-child(3) .circle').addClass('circle--active')
                        
                            if (this.docW > 1003) {
                                $('.bar-front').width(480)
                            } else if (this.docW <= 1003) {
                                $('.bar-front').width(440)
                            }
                        
                        } else if (this.countStep % 5  == 3) {
                            if(this.shapeIndex != 0){
                                console.log('讓尾翼不能選')
                                $('.selectA6').addClass('btn--disabled')
                                $('.selectA6').removeClass('btn--outline')
                                $('.selectA6').css({"pointer-events":"none"})
                            }
                        
                            console.log(this.countStep)
                        
                            $('.nextStep').addClass('btn--disabled')
                        
                            //進入選配件
                            $('.tireCard').css({"display": "none"})
                        
                            //提醒內容變更
                            $('.pleaseSelect').text('請先選擇配件才能進入下一步喔')
                        
                            $('.accessoryCards').css({"display": "flex"})
                            $('.accessoryCard').css({"display": "block"
                            })
                        
                            //進度條、圓圈變色
                            $('.content:nth-child(4) .circle').addClass('circle--able')
                            $('.content:nth-child(4) .circle').addClass('circle--active')
                        
                        
                            if (this.docW > 1003) {
                                $('.bar-front').width(730)
                            } else if (this.docW <= 1003) {
                                $('.bar-front').width(660)
                            }
                        } else if (this.countStep % 5 == 4) {
                            console.log(this.countStep)
                        
                            $('.nextStep').addClass('btn--disabled').text('完成')
                            $('.nextStep').addClass('finish')
                        
                            $('.selectArea').css({"display": "none"})
                        
                            $('.giveName').css({
                                "display": "flex",
                                "justify-content": "space-between"
                            })
                        
                            //左右紐消失
                            $('.selectBtn').css({"display": "none"})
                        
                            //提醒內容變更
                            $('.pleaseSelect').text('請先填寫完資料才能完成作品喔')
                        
                            //進度條、圓圈變色
                            $('.content:nth-child(5) .circle').addClass('circle--able')
                            $('.content:nth-child(5) .circle').addClass('circle--active')
                        
                            if(this.docW > 1003){
                                $('.bar-front').width(960) 
                            }else if(this.docW <= 1003){
                                $('.bar-front').width(840) 
                            }
                            //base64
                            dataURL = document.querySelector('.canvas').toDataURL();
                            dataURLA1 = document.querySelector('.canvasA1').toDataURL();
                            dataURLA2 = document.querySelector('.canvasA2').toDataURL();
                            dataURLA3 = document.querySelector('.canvasA3').toDataURL();
                            console.log(dataURL)
                        }
                    }
                },
                toPreviousStep(){ //點上一步回上一步
                    this.countStep -= 1
                    console.log("previousStep is clicked! countStep: " + this.countStep)

                    if (this.countStep % 5 == 0) {
                        $('.colorCards').css({"display": "none"})
                        $('.shapeCards').css({"display": "flex"})
                        $('.shapeCard').css({"display": "block"})
                    
                        $('.content:nth-child(2) .circle').css({"background-color": "#D8D8D8"})
                    
                        $('.previousStep').addClass('invisible')
                    
                        if (this.docW > 1003) {
                                $('.bar-front').width(0)
                        } else if (this.docW <= 1003) {
                                $('.bar-front').width(0)
                        }
                    } else if (this.countStep % 5 == 1) {
                        $('.tireCards').css({"display": "none"})
                        $('.colorCards').css({"display": "flex"})
                        $('.colorCard').css({"display": "block"})

                        $('.content:nth-child(3) .circle').css({"background-color": "#D8D8D8"})
                        $(this).removeClass('invisible')
                    
                        $('.nextStep').removeClass('btn--disabled')
                    
                        if (this.docW > 1003) {
                                $('.bar-front').width(240)
                        } else if (this.docW <= 1003) {
                                $('.bar-front').width(220)
                        }
                    } else if (this.countStep % 5 == 2) {
                        $('.accessoryCards').css({"display": "none"})
                        $('.tireCards').css({"display": "flex"})
                        $('.tireCard').css({"display": "block"})
                    
                        $('.content:nth-child(4) .circle').css({"background-color": "#D8D8D8"})
                        $('.nextStep').removeClass('btn--disabled')
                    
                        if (this.docW > 1003) {
                                $('.bar-front').width(480)
                        } else if (this.docW <= 1003) {
                                $('.bar-front').width(440)
                        }
                    } else if (this.countStep % 5 == 3) {
                        $('.giveName').css({"display": "none"})
                        $('.selectArea').css({"display": "block"})
                        $('.accessoryCards').css({"display": "flex"})
                        $('.accessoryCard').css({"display": "block"})
                    
                        $('.content:nth-child(5) .circle').css({"background-color": "#D8D8D8"})
                        if (this.docW > 1003) {
                                $('.bar-front').width(730)
                        } else if (this.docW <= 1003) {
                                $('.bar-front').width(660)
                        }
                    }else{//countStep % 5 == 4
                        $('.giveName').css({"display": "none"})
                        $('.selectArea').css({"display": "block"})
                        $('.accessoryCards').css({"display": "block"})
                    }
                },
                getShapeIndex(e){
                    //抓取車型的index(用來判別顏色圖要貼甚麼)
                    this.shapeIndex = $(e.target).parent().index();
                    console.log(this.shapeIndex)
                },
                getCircleIndex(e){
                    circleIndex = $(e.target).parent().index();
                    console.log("circleIndex: " + circleIndex)
                },
                moveRight(){
                    this.countL += 1;

                    let distanceToLeft = $('.selectArea').position().left;
                    // console.log(distanceToLeft)

                    if (this.docW <= 992) {
                        if (this.countStep < 3 && distanceToLeft > -900) {
                            $('.selectArea').animate({left: '-=430'});
                        } else if (this.countStep == 3 && distanceToLeft > -2100) {
                        
                            $('.selectArea').animate({left: '-=410'});
                        }
                    } else {
                        if (this.countStep < 3 && distanceToLeft > 15) {
                            $('.selectArea').animate({left: '-=410'});
                        } else if (this.countStep == 3 && distanceToLeft > -400) {
                            // console.log('再過去一點')
                            $('.selectArea').animate({left: '-=410'});
                        }
                    }
                },
                moveLeft(){
                    this.countR += 1;
                    console.log('countR: '+ this.countR);
                    // console.log('docW: '+ docW)

                    let shapeLength = $('.shapeCard').length
                    // console.log(shapeLength)

                    let colorLength = $('.selectColor').length
                    // console.log(colorLength)
                    // console.log("countStep:  " + countStep)

                    let distanceToLeft = $('.selectArea').position().left;
                    // console.log(distanceToLeft)

                    if (this.docW <= 992) {
                        if (this.countStep == 0 && distanceToLeft < 3) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 1 && distanceToLeft < 3 && distanceToLeft > (-1300)) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 2 && distanceToLeft < 3 && distanceToLeft > (-1300)) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 3 && distanceToLeft < 14 && distanceToLeft > (-2100)) {
                            $('.selectArea').animate({left: '+=410'});
                        }
                    } else {
                        if (this.countStep == 0 && distanceToLeft < 14) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 1 && distanceToLeft < 14 && distanceToLeft > (-400)) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 2 && distanceToLeft < 14 && distanceToLeft > (-400)) {
                            $('.selectArea').animate({left: '+=410'});
                        } else if (this.countStep == 3 && distanceToLeft < 14 && distanceToLeft > (-920)) {
                            $('.selectArea').animate({left: '+=410'});
                        }
                    }
                },
                sort(){
                   let postTimes = $('.mainTime').text().split('小時前');
                   console.log(postTimes)
                //    console.log(postTimes.length)

                   for(i = 0; i < postTimes.length - 1; i++){
                    console.log(postTimes[i])
                   }

                //    $('.work:nth-child(1)').css({"position":"initial","order":"5"})
                //    $('.work:nth-child(2)').css({"position":"initial","order":"1"})
                //    $('.work:nth-child(3)').css({"position":"initial","order":"4"})
                //    $('.work:nth-child(4)').css({"position":"initial","order":"2"})
                //    $('.work:nth-child(5)').css({"position":"initial","order":"6"})
                //    $('.work:nth-child(6)').css({"position":"initial","order":"3"})

                //    $('.grid').masonry({
                //       // options
                //       horizontalOrder: true,
                //       itemSelector: '.grid-item',
                //       columnWidth: 466
                //    });
                }
            },
        });

        new Vue({ //主體
            el: '#factoryModal',
            props:{
                img:{
                    default:"./assets/img/pic/model04.png",
                    type:String
                },
                goodNum:{
                    default:0,
                    type:Number
                },
                commentNum:{
                    default:0,
                    type:Number
                },
            },
            data:{
                is_icon_color:false,
                goodNum_plus: this.goodNum,
                commentNum_plus: this.commentNum
            },

            methods: {
                closeWorkModal(){ //關掉彈窗
                        $('.mask').css({"display": "none",});
                    
                        $('#factoryModal').css({"margin": "0 auto",});
                },
                coloredIcon(e){
                    this.is_icon_color = true

                    // console.log('變色囉')
                    // $(e.target).children('g').children('path').addClass('pin--secondary')            
                },
                noColorIcon(e){
                    this.is_icon_color = false
                    // console.log('變回去囉')
                    // $(e.target).children('g').children('path').removeClass('pin--secondary')  
                },
                addGoodNum(e){
                    this.goodNum_plus += 1;

                    // ajax
                },
                closeModal(){
                    console.log('關掉喔')
                    $('.modal').removeClass('modal-active');
                }

            },
        });

        // const vm2 = new Vue({ //設定彈窗的作用域
        //     el: '#app2',
        //     methods: {
        //         closeWorkModal(){ //關掉彈窗
        //                 $('.mask').css({"display": "none",});
                    
        //                 $('.containerMain').css({"position": "initial",});
        //         },
        //     },
        // });

        new Vue({ //設定進度條的作用域
            el: '#progressBar',
        });

        let empty = new Vue({ //設定empty-state的作用域
            el: '#mywork',
        })

        // ----------------------JQ區----------------------
        //計算輸入框內的剩餘字數，按進去沒輸入字變紅框
        let textMax = 100;
        $('.textCount').text(`餘${textMax}字`);

        $('textarea').keyup(function() {
            let textLength = $(this).val().length;
            // console.log(textLength)

            $(this).parent().children('.other').children('.textCount').text(`餘${textMax - textLength}字`);

            if (textLength > 0) {
                $(this).css({
                    "border": "1px solid #000",
                })
            }
        })

        //選擇後「下一步」變able、提醒先做選則才進入下一步的提示消失
        // 選擇的項目標示顏色、單選的情況其他沒選的不標色
        $('.selectShape').click(() => {
            $('.nextStep').removeClass('btn--disabled')
            $('.pleaseSelect').css({"display": "none"})

            $(this).removeClass('btn--outline')

            $(this).parent().siblings().children('.btn').addClass('btn--outline')
        })

        $('.selectColor').click(() => {
            $('.nextStep').removeClass('btn--disabled')
            $('.pleaseSelect').css({"display": "none"})

            $(this).removeClass('btn--outline')

            $(this).parent().siblings().children('.btn').addClass('btn--outline')
        })

        $('.selectTire').click(() => {
            $('.nextStep').removeClass('btn--disabled')
            $('.pleaseSelect').css({"display": "none"})

            $(this).removeClass('btn--outline')

            $(this).parent().siblings().children('.btn').addClass('btn--outline')
        })

        $('.selectAccessory').click(() => {
            $('.nextStep').removeClass('btn--disabled')
            $('.pleaseSelect').css({"display": "none"})
        })

        //點下一步後跳到選色步驟、跳選輪子步驟 //移到Vue
        // let countStep = 0;
        // let docW = $(document).width();
        // $('.nextStep').click(() => {
        //     console.log("nextStep is clicked! countStep: "+ countStep)
        //     // console.log(docW)

        //     if ($('.nextStep').hasClass('btn--disabled')) {

        //         $('.pleaseSelect').css({"display": "block"})

        //         setTimeout(() => {
        //             $('.pleaseSelect').css({"display": "none"})
        //         }, 1000);
        //     } else {
        //         $('.previousStep').removeClass('invisible')

        //         countStep += 1;
        //         $('.shapeCard').css({"display": "none"})

        //         if (countStep % 5 == 1) {
        //             console.log(countStep)
        //             $('.nextStep').addClass('btn--disabled')
                    

        //             //進入選顏色
        //             $('.colorCards').css({"display": "flex"})
        //             $('.colorCard').css({"display": "block"})

        //             //提醒內容變更
        //             $('.pleaseSelect').text('請先選擇烤漆才能進入下一步喔')

        //             //進度條、圓圈變色
        //             $('.content:nth-child(2) .circle').addClass('circle--able')
        //             $('.content:nth-child(2) .circle').addClass('circle--active')

        //             if (docW > 1003) {
        //                 $('.bar-front').width(240)
        //             } else if (docW <= 1003) {
        //                 $('.bar-front').width(220)
        //             }

        //         } else if (countStep % 5  == 2) {
        //             console.log(countStep)

        //             $('.nextStep').addClass('btn--disabled')

        //             //進入選輪子
        //             $('.colorCard').css({"display": "none"})

        //             $('.tireCards').css({"display": "flex"})
        //             $('.tireCard').css({"display": "block"})

        //             //提醒內容變更
        //             $('.pleaseSelect').text('請先選擇輪胎才能進入下一步喔')

        //             //進度條變色
        //             $('.content:nth-child(3) .circle').addClass('circle--able')
        //             $('.content:nth-child(3) .circle').addClass('circle--active')

        //             if (docW > 1003) {
        //                 $('.bar-front').width(480)
        //             } else if (docW <= 1003) {
        //                 $('.bar-front').width(440)
        //             }

        //         } else if (countStep % 5  == 3) {
        //             if(shapeIndex != 0){
        //                 console.log('讓尾翼不能選')
        //                 $('.selectA6').addClass('btn--disabled')
        //                 $('.selectA6').removeClass('btn--outline')
        //                 $('.selectA6').css({"pointer-events":"none"})
        //             }

        //             console.log(countStep)

        //             $('.nextStep').addClass('btn--disabled')

        //             //進入選配件
        //             $('.tireCard').css({"display": "none"})

        //             //提醒內容變更
        //             $('.pleaseSelect').text('請先選擇配件才能進入下一步喔')

        //             $('.accessoryCards').css({"display": "flex"})
        //             $('.accessoryCard').css({"display": "block"
        //             })

        //             //進度條、圓圈變色
        //             $('.content:nth-child(4) .circle').addClass('circle--able')
        //             $('.content:nth-child(4) .circle').addClass('circle--active')


        //             if (docW > 1003) {
        //                 $('.bar-front').width(730)
        //             } else if (docW <= 1003) {
        //                 $('.bar-front').width(660)
        //             }
        //         } else if (countStep % 5 == 4) {
        //             console.log(countStep)

        //             $('.nextStep').addClass('btn--disabled').text('完成')
        //             $('.nextStep').addClass('finish')

        //             $('.selectArea').css({"display": "none"})

        //             $('.giveName').css({
        //                 "display": "flex",
        //                 "justify-content": "space-between"
        //             })

        //             //左右紐消失
        //             $('.selectBtn').css({"display": "none"})

        //             //提醒內容變更
        //             $('.pleaseSelect').text('請先填寫完資料才能完成作品喔')

        //             //進度條、圓圈變色
        //             $('.content:nth-child(5) .circle').addClass('circle--able')
        //             $('.content:nth-child(5) .circle').addClass('circle--active')

        //             if(docW > 1003){
        //                 $('.bar-front').width(960) 
        //             }else if(docW <= 1003){
        //                 $('.bar-front').width(840) 
        //             }
        //         }
        //     }
        // })

        // $('.make').click(() => { //移到Vue
            // console.log('清空')
        //     context.clearRect(0, 0, 400, 200)
        //     contextA1.clearRect(0, 0, 400, 200)
        //     contextA2.clearRect(0, 0, 400, 200)
        //     contextA3.clearRect(0, 0, 400, 200)
        //     $(this).removeClass('finish')
        // })

        //上一步 //移到Vue
        // $('.previousStep').click(function() {
        //     countStep -= 1
        //     console.log("previousStep is clicked! countStep: " + countStep)

        //     if (countStep % 5 == 0) {
        //         $('.colorCards').css({"display": "none"})
        //         $('.shapeCards').css({"display": "flex"})
        //         $('.shapeCard').css({"display": "block"})

        //         $('.content:nth-child(2) .circle').css({"background-color": "#D8D8D8"})

        //         $('.previousStep').addClass('invisible')

        //         if (docW > 1003) {
        //                 $('.bar-front').width(0)
        //         } else if (docW <= 1003) {
        //                 $('.bar-front').width(0)
        //         }

        //     } else if (countStep % 5 == 1) {
        //         $('.tireCards').css({"display": "none"})
        //         $('.colorCards').css({"display": "flex"})
        //         $('.colorCard').css({"display": "block"})
                
        //         $('.content:nth-child(3) .circle').css({"background-color": "#D8D8D8"})
        //         $(this).removeClass('invisible')

        //         $('.nextStep').removeClass('btn--disabled')

        //         if (docW > 1003) {
        //                 $('.bar-front').width(240)
        //         } else if (docW <= 1003) {
        //                 $('.bar-front').width(220)
        //         }
        //     } else if (countStep % 5 == 2) {
        //         $('.accessoryCards').css({"display": "none"})
        //         $('.tireCards').css({"display": "flex"})
        //         $('.tireCard').css({"display": "block"})

        //         $('.content:nth-child(4) .circle').css({"background-color": "#D8D8D8"})
        //         $('.nextStep').removeClass('btn--disabled')

        //         if (docW > 1003) {
        //                 $('.bar-front').width(480)
        //         } else if (docW <= 1003) {
        //                 $('.bar-front').width(440)
        //         }
        //     } else if (countStep % 5 == 3) {
        //         $('.giveName').css({"display": "none"})
        //         $('.selectArea').css({"display": "block"})
        //         $('.accessoryCards').css({"display": "flex"})
        //         $('.accessoryCard').css({"display": "block"})

        //         $('.content:nth-child(5) .circle').css({"background-color": "#D8D8D8"})
        //         if (docW > 1003) {
        //                 $('.bar-front').width(730)
        //         } else if (docW <= 1003) {
        //                 $('.bar-front').width(660)
        //         }
        //     }else{//countStep % 5 == 4
        //         $('.giveName').css({"display": "none"})
        //         $('.selectArea').css({"display": "block"})
        //         $('.accessoryCards').css({"display": "block"})


        //     }
        // })

        // console.log(countStep)
        //先抓取進度條圓圈(circle)的index //移到Vue
        // $('.circle').click((e) => {
        //     circleIndex = $(e.target).parent().index();
        //     console.log("circleIndex: " + circleIndex)
        // })


        //若沒有輸入所有資料跳出請完成資料輸入
        // $('.nextStep').click(function() {
            // let typeWorkName = $('.typeWorkName').val()
            // let typeNickName = $('.typeNickName').val()
            // let typeInspiration = $('.typeInspiration').val()

            // let typeWorkNameL = $('.typeWorkName').val().length;
            // let typeNickNameL = $('.typeNickName').val().length;
            // let typeInspirationL = $('.typeInspiration').val().length;

            // //如果作品名、作者暱稱、靈感皆不為空則PO文
            // if (typeWorkNameL > 0 && typeNickNameL > 0 && typeInspirationL > 0) {
            //     let x = `<li class="work col-4 col-lg-2 col-sm-4">
            //             <div class="work_pic">
            //                 <img src="data:image/png;${dataURL}" class="layer1">
            //                 <img src="data:image/png;${dataURLA1}" class="layer2">
            //                 <img src="data:image/png;${dataURLA2}" class="layer3">
            //                 <img src="data:image/png;${dataURLA3}" class="layer4">
            //             </div>

            //             <div class="work_author">
            //                 <img src="./assets/img/pic/userPic.png"  class="userPic">
            //                 <div class="userContent">
            //                     <p class="userName h6">${typeWorkName}</p>
            //                     <h2 class="workName h4">${typeNickName}</h2>
            //                     <p class="userContent h5">${typeInspiration}</p>
            //                     <div class="other">
            //                         <p class="postTime h6">3小時前</p>
            //                         <div class="other_right">
            //                             <button class="btn btn--link h5 mr-4">編輯</button>
            //                             <button class="btn btn--link h5">刪除</button>
            //                         </div>
            //                     </div>
            //                 </div>
            //             </div>

            //             <div class="workInfo">
            //                 <div class="workInfo_good">
            //                     <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon goodIcon">
            //                         <g transform="translate(-729 -275)">
            //                             <path d="M14.513,37.47l10.1.209c4.043,0,8.616-5.286,9.752-7.915,0,0,3.514-7.2,2.541-12.055-1.78-3.084-4.026-2.219-13.046-2.219l1.545-7,.052-.515a2.489,2.489,0,0,0-.713-1.743L23.013,4.5,12.194,15.43a3.3,3.3,0,0,0-.944,2.327V34.241A3.237,3.237,0,0,0,14.513,37.47Z" transform="translate(735.366 280.5)" fill="none" stroke="#E59807" stroke-linecap="round" stroke-linejoin="round" stroke-width="4"/>
            //                             <path d="M3.375,15.75H8.87V34.982H3.375Z" transform="translate(733.625 282.987)" fill="#E59807"/>
            //                         </g>
            //                     </svg>
            //                     <p  class="num h3">0</p>
            //                 </div>
            //                 <div class="workInfo_reply">
            //                     <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 52 52" class="icon commentIcon">
            //                         <g transform="translate(-396.868 -362.313)">
            //                             <path  d="M413.686,374.254c-8.888,0-16.12,6.165-16.12,13.743a12.384,12.384,0,0,0,3.545,8.634l0,0,0,0a5.214,5.214,0,0,1,1.473,3.662,6.52,6.52,0,0,1,2-.328,5.51,5.51,0,0,1,2.032.38h.006a18.861,18.861,0,0,0,7.058,1.389c8.888,0,16.12-6.165,16.12-13.745s-7.232-13.743-16.12-13.743m0-4.666c11.479,0,20.786,8.242,20.786,18.41s-9.307,18.411-20.786,18.411a23.417,23.417,0,0,1-8.774-1.716.893.893,0,0,0-.322-.055c-1.569,0-4.921,3.126-6.8,3.126a1.16,1.16,0,0,1-.7-.209c-1.973-1.66,1.569-6.761.7-7.646A17.091,17.091,0,0,1,392.9,388C392.9,377.83,402.206,369.588,413.686,369.588Z" transform="translate(8.967 -0.274)" fill="#E59807"/>
            //                             <circle cx="2.4" cy="2.4" r="2.4" transform="translate(413 386)" fill="#E59807"/>
            //                             <circle cx="2.4" cy="2.4" r="2.4" transform="translate(420 386)" fill="#E59807"/>
            //                             <circle cx="2.4" cy="2.4" r="2.4" transform="translate(427 386)" fill="#E59807"/>
            //                         </g>
            //                     </svg>
            //                     <p  class="num h3">0</p>
            //                 </div>
            //             </div>

            //             <div class="typeReply">
                            
            //                 <img src="./assets/img/pic/userPic.png" class="userPic replyerPic">
        
            //                 <div class="typeReply_right">
            //                   <p class="replyerName">沾醬大師</p>
            //                   <textarea name="" id="" cols="24" rows="5" placeholder="讚美這個作品，或發表看法。" class="textarea"></textarea>
            //                   <div class="other">
            //                     <p class="textCount"></p>
            //                     <button class="btn btn--small h5 comment">留言</button>
            //                   </div>
            //                 </div>
            //             </div>
            //         </li>`

            //     //PO到我的車車
            //     $('.emptyState').css({"display": "none"})
            //     $('.mywork .putMywork').append(x)

            //     //PO完後清空填寫的資料
            //     $('.typeWorkName').val('')
            //     $('.typeNickName').val('')
            //     $('.typeInspiration').val('')

            //     //PO完回到第一頁
            //     $('.makeCar').css({"display": "none"})
            //     $('.giveName').css({
            //         "display": "none"
            //     })
            //     $('.selectArea').css({"display": "block"})
            //     $('.selectBtn').css({"display": "flex"})

            //     $('.shapeCards').css({"display": "flex"})
            //     $('.shapeCard').css({"display": "block"})

            //     $('.colorCards').css({"display": "none"})
            //     $('.tireCards').css({"display": "none"})
            //     $('.accessoryCards').css({"display": "none"})

            //     $('.intro').css({"display": "flex"})

            //     let count6 = 0;
            //     $('.closeTextarea').click(function() {
            //         // console.log('關掉textarea')
            //         $(this).parent().children('.typeReply').slideToggle();
            //         count6 += 1;
            //         // console.log(count6);
            //         if (count6 % 2 == 1) {
            //             $(this).children('.textareaWord').text('打開輸入框');
            //             $(this).children('.toggleIcon3').css({
            //                 "transform": "rotate(180deg)",
            //             })
            //         } else {
            //             $(this).children('.textareaWord').text('關閉輸入框');
            //             $(this).children('.toggleIcon3').css({
            //                 "transform": "rotate(0deg)",
            //             })
            //         }
            //     }) 
                
            //     //PO完後再跑一次這段，讓我的作品的goodIcon mouseover時有反應
            //     $('.goodIcon').mouseover((e) => {
            //         // console.log('變色')
            //         $(e.target).children('g').children('path').addClass('pin--secondary')            
            //     })

            //     $('.goodIcon').mouseout((e) => {
            //         // console.log('變回去')
            //         $(e.target).children('g').children('path').removeClass('pin--secondary')         
            //     })
            // }
        // })


        //完成資料輸入後按鈕自動變able、移除提示
        $('.giveName').change(function() {
            let typeWorkNameL = $('.typeWorkName').val().length;
            let typeNickNameL = $('.typeNickName').val().length;
            let typeInspirationL = $('.typeInspiration').val().length;

            if (typeWorkNameL > 0 && typeNickNameL > 0 && typeInspirationL > 0) {
                $('.pleaseSelect').css({
                    "display": "none"
                })
                $('.finish').removeClass('btn--disabled')
            }
        })

        //隨機取名
        $('.randomName').click(function() {
            let nameArr1 = ['地瓜', '蓮霧', '芋圓', '天竺鼠', '賓士貓', '長毛貓', '白襪貓', '短腿柯基', '犀牛', '脖子長長頸鹿']
            let nameArr2 = ['轎車', '跑車', '小客車', '巴士', '休旅車', '箱型車', '敞篷車', '公車', '警車', '消防車']

            let ran1 = Math.floor(Math.random() * 10)
            let ran2 = Math.floor(Math.random() * 10)

            $('.typeWorkName').val(nameArr1[ran1] + nameArr2[ran2])
        })

        // let countL = 0;
        // let countR = 0;
        // let distance = 410;
        //選擇車型、零件的區域按左右會移動
        // $('.selectAreaOut-next').click(function() { //移到Vue
            // countL += 1;
            // // console.log("countL ":+ countL);
            // // console.log("countStep: " + countStep)
            // // console.log('docW: '+ docW)

            // let distanceToLeft = $('.selectArea').position().left;
            // // console.log(distanceToLeft)

            // if (docW <= 992) {
            //     if (countStep < 3 && distanceToLeft > -900) {
            //         $('.selectArea').animate({
            //             left: '-=430'
            //         });
            //     } else if (countStep == 3 && distanceToLeft > -2100) {

            //         $('.selectArea').animate({
            //             left: '-=410'
            //         });
            //     }
            // } else {
            //     if (countStep < 3 && distanceToLeft > 15) {
            //         $('.selectArea').animate({
            //             left: '-=410'
            //         });
            //     } else if (countStep == 3 && distanceToLeft > -400) {
            //         // console.log('再過去一點')
            //         $('.selectArea').animate({
            //             left: '-=410'
            //         });
            //     }
            // }
        // })

        // $('.selectAreaOut-previous').click(function() { //移到Vue
            // countR += 1;
            // console.log('countR: '+ countR);
            // // console.log('docW: '+ docW)

            // let shapeLength = $('.shapeCard').length
            //     // console.log(shapeLength)

            // let colorLength = $('.selectColor').length
            //     // console.log(colorLength)

            // // console.log("countStep:  " + countStep)

            // let distanceToLeft = $('.selectArea').position().left;
            // // console.log(distanceToLeft)

            // if (docW <= 992) {
            //     if (countStep == 0 && distanceToLeft < 3) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 1 && distanceToLeft < 3 && distanceToLeft > (-1300)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 2 && distanceToLeft < 3 && distanceToLeft > (-1300)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 3 && distanceToLeft < 14 && distanceToLeft > (-2100)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     }
            // } else {
            //     if (countStep == 0 && distanceToLeft < 14) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 1 && distanceToLeft < 14 && distanceToLeft > (-400)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 2 && distanceToLeft < 14 && distanceToLeft > (-400)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     } else if (countStep == 3 && distanceToLeft < 14 && distanceToLeft > (-920)) {
            //         $('.selectArea').animate({
            //             left: '+=410'
            //         });
            //     }
            // }
        // })

        // ---------------------------------計算金額------------------------------------------------

        $('.selectShape').click(function() {
            let totalPriceInit = $('.totalPrice').text().split(' ')[1]
            // console.log("totalPriceInit: " + totalPriceInit)

            let shapePrice = $(this).parent().children('.makeCar-price').text().split(' ')[1]
            // console.log(shapePrice);

            let finalPrice = $('.totalPrice').text().split(' ')[1]
            stage1Price = $('.totalPrice').text(`NT$ ${shapePrice}`)
            stage1Price2 = stage1Price.text().split(' ')[1] //設成全域，下一階段要用這個數
            // console.log('stage1: ' + stage1Price2)
        })

        $('.selectColor').click(function() {
            // console.log(stage1Price2)

            let colorPrice = $(this).parent().children('.makeCar-price').text().split(' ')[1]
            // console.log("colorPrice: " + colorPrice);

            stage2Price = parseInt(stage1Price2) + parseInt(colorPrice) //設成全域，下一階段要用這個數
            // console.log("stage2:" + stage2Price)

            stage2Price2 = $('.totalPrice').text(`NT$ ${stage2Price}`)
        })

        $('.selectTire').click(function() {
            // console.log(stage2Price)

            let tirePrice = $(this).parent().children('.makeCar-price').text().split(' ')[1]
            // console.log("tirePrice: " + tirePrice);

            state3Price = parseInt(stage2Price) + parseInt(tirePrice)
            // console.log("state3:" + state3Price)

            state3Price2 = $('.totalPrice').text(`NT$ ${state3Price}`)
        })


        //計算零件的金額

        $('.selectAccessory').click(function() {
            let state4Price0 = $('.totalPrice').text().split(' ')[1]
            // console.log(state4Price0)

            if($(this).hasClass('btn--outline')){ //當從沒選零件變成有選零件的時候加錢
                let accessoryPrice = $(this).parent().children('.makeCar-price').text().split(' ')[1]
                // console.log("accessoryPrice: " + accessoryPrice);
                
                let stage4Price = parseInt(state4Price0) + parseInt(accessoryPrice)
                // console.log("stage4:" + stage4Price)
                
                let finalPrice = $('.totalPrice').text(`NT$ ${stage4Price}`)
            
                
            }else{ //當從有選零件變成沒選零件時，扣掉原本加上去的錢
                let state4Price1 = $('.totalPrice').text().split(' ')[1]
                console.log(state4Price1)

                let accessoryPrice = $(this).parent().children('.makeCar-price').text().split(' ')[1]
                
                let stage4Price = parseInt(state4Price1) - parseInt(accessoryPrice)

                let finalPrice = $('.totalPrice').text(`NT$ ${stage4Price}`)

            }
        })

        // -------------------------------------CANVAS--------------------------------------------
        //建立環境
        let canvas = document.querySelector('.canvas');
        let context = canvas.getContext('2d');

        let canvasA1 = document.querySelector('.canvasA1');
        let contextA1 = canvasA1.getContext('2d');

        let canvasA2 = document.querySelector('.canvasA2');
        let contextA2 = canvasA2.getContext('2d');

        let canvasA3 = document.querySelector('.canvasA3');
        let contextA3 = canvasA3.getContext('2d');

        //綁定事件
        $('.make').click(defaultShape)
        $('.selectShape').click(buildCanvas);

        function defaultShape(){
            let pic1 = new Image();
            pic1.src = `./assets/img/pic/shape01.png`; //放上預設車型
            pic1.addEventListener('load', function() {
                context.globalAlpha = 0.5;
                context.drawImage(pic1, 0, -100);
            })
        }

        function buildCanvas(e) {
            //先清空
            context.clearRect(0, 0, canvas.width, canvas.height);

            let targetShape = $(e.target).parent().children('.cardOut').children('.shape').attr('src');
            // console.log(targetShape)

            let pic1 = new Image();
            pic1.src = `${targetShape}`; //放上車型
            pic1.addEventListener('load', function() {
                context.globalAlpha = 1;
                context.drawImage(pic1, 0, -100);
            })
        }

        //疊上顏色        //移到Vue
        // $('.selectShape').click(function() {
        //     //抓取車型的index(用來判別顏色圖要貼甚麼)
        //     shapeIndex = $(this).parent().index();
        //     // console.log(shapeIndex)
        // })

        $('.selectWhite').click(function() {
            let pic2 = new Image();
            // if (shapeIndex == 0) { //暫時關掉
            //     pic2.src = './assets/img/pic/color1A.png'; //白
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 1) {
            //     pic2.src = './assets/img/pic/color1B.png'; //白
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })

            // } else if (shapeIndex == 2 || shapeIndex == 3) {
            //     pic2.src = './assets/img/pic/color1C.png'; //白
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, -1, -117);
            //     })
            // }
        })

        $('.selectRed').click(function() {
            let pic2 = new Image();
            // if (shapeIndex == 0) { //暫時關掉
            //     pic2.src = './assets/img/pic/color2A.png'; //紅
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 1) {
            //     pic2.src = './assets/img/pic/color2B.png'; //紅
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 2 || shapeIndex == 3) {
            //     pic2.src = './assets/img/pic/color2C.png'; //紅
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, -1, -117);
            //     })
            // }
        })

        $('.selectOrange').click(function() {
            let pic2 = new Image();
            // if (shapeIndex == 0) { //暫時關掉
            //     pic2.src = './assets/img/pic/color3A.png'; //橙
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 1) {
            //     pic2.src = './assets/img/pic/color3B.png'; //橙
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 2 || shapeIndex == 3) {
            //     pic2.src = './assets/img/pic/color3C.png'; //橙
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, -1, -117);
            //     })
            // }
        })

        $('.selectYellow').click(function() {
            let pic2 = new Image();

            // if (shapeIndex == 0) { //暫時關掉
            //     pic2.src = './assets/img/pic/color4A.png'; //黃
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 1) {
            //     pic2.src = './assets/img/pic/color4B.png'; //黃
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 2 || shapeIndex == 3) {
            //     pic2.src = './assets/img/pic/color4C.png'; //黃
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, -1, -117);
            //     })
            // }
        })

        $('.selectPurple').click(function() {
            let pic2 = new Image();

            // if (shapeIndex == 0) { //暫時關掉
            //     pic2.src = './assets/img/pic/color5A.png'; //紫
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 1) {
            //     pic2.src = './assets/img/pic/color5B.png'; //紫
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, 0, -100);
            //     })
            // } else if (shapeIndex == 2 || shapeIndex == 3) {
            //     pic2.src = './assets/img/pic/color5C.png'; //紫
            //     pic2.addEventListener('load', function() {
            //         context.globalAlpha = 1;
            //         context.drawImage(pic2, -1, -117);
            //     })
            // }
        })

        //疊上輪子
        $('.selectT1').click(function() {
            let pic3 = new Image();
            pic3.src = './assets/img/pic/tire01.png'; //輪子1
            pic3.addEventListener('load', function() {
                context.globalAlpha = 1;
                context.drawImage(pic3, 0, -100);
            })
        })

        $('.selectT2').click(function() {
            let pic3 = new Image();
            pic3.src = './assets/img/pic/tire02.png'; //輪子2
            pic3.addEventListener('load', function() {
                context.globalAlpha = 1;
                context.drawImage(pic3, 0, -100);
            })
        })

        $('.selectT3').click(function() {
            let pic3 = new Image();
            pic3.src = './assets/img/pic/tire03.png'; //輪子3
            pic3.addEventListener('load', function() {
                context.globalAlpha = 1;
                context.drawImage(pic3, 0, -100);
            })
        })

        $('.selectT4').click(function() {
            let pic3 = new Image();
            pic3.src = './assets/img/pic/tire04B.png'; //輪子4
            pic3.addEventListener('load', function() {
                context.globalAlpha = 1;
                context.drawImage(pic3, 5, -105);
            })
        })

        //疊上配件
        let click1 = 0;
        let click2 = 0;
        let click3 = 0;
        let click4 = 0;
        let click5 = 0;
        let click6 = 0;

        $('.selectA1').click(function() {
            click1++;

            if(click1 % 2 == 1){
                let pic4 = new Image();
                pic4.src = './assets/img/pic/accessory1.png'; //圓形燈飾

                pic4.addEventListener('load', function() {
                    contextA1.globalAlpha = 1;
                    contextA1.drawImage(pic4, 0, -120);
                })

                $(this).removeClass('btn--outline')
                $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
            }else{
                contextA1.clearRect(0, 0, 400, 50);

                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }
        })

        $('.selectA2').click(function() {
            click2++;

            if(click2 % 2 == 1){
                let pic4 = new Image();
                pic4.src = './assets/img/pic/accessory2.png'; //藍燈飾
                pic4.addEventListener('load', function() {
                    contextA2.globalAlpha = 1;
                    contextA2.drawImage(pic4, 0, -120);
                })

                $(this).removeClass('btn--outline')
                $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
            }else{
                contextA2.clearRect(0, 0, 400, 50);

                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }
        })

        $('.selectA3').click(function() {
            click3++;

            if(click3 % 2 == 1){
                let pic4 = new Image();
                pic4.src = './assets/img/pic/accessory3.png'; //紅藍燈飾
                pic4.addEventListener('load', function() {
                    contextA3.globalAlpha = 1;
                    contextA3.drawImage(pic4, 0, -120);
                })
                                
                $(this).removeClass('btn--outline')
                $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
            }else{
                contextA3.clearRect(0, 0, 400, 50);

                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }
        })

        $('.selectA4').click(function() {
            click4++;

            if(click4 % 2 == 1){
                let pic4 = new Image();
                pic4.src = './assets/img/pic/accessory4.png'; //動物圖案
                pic4.addEventListener('load', function() {
                    contextA1.globalAlpha = 1;
                    contextA1.drawImage(pic4, 40, -100);
                })
                                
                $(this).removeClass('btn--outline')
                $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
            }else{
                contextA1.clearRect(0, 50, 400, 150);

                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }
        })

        $('.selectA5').click(function() {
            click5++;

            if(click5 % 2 == 1){
                let pic4 = new Image();
                pic4.src = './assets/img/pic/accessory5.png'; //馬圖案
                pic4.addEventListener('load', function() {
                    contextA2.globalAlpha = 1;
                    contextA2.drawImage(pic4, 20, -100);
                })
                                
                $(this).removeClass('btn--outline')
                $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
            }else{
                contextA2.clearRect(0, 50, 400, 150);
            
                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }
        })

        $('.selectA6').click(function() {
            click6++;

            if(click6 % 2 == 1){
                let pic4 = new Image();
                // if (shapeIndex == 0) {
                //     // console.log('shapeIndex = 0')
                //     pic4.src = './assets/img/pic/accessory6.png'; //白尾翼
                //     pic4.addEventListener('load', function() {
                //         contextA3.globalAlpha = 1;
                //         contextA3.drawImage(pic4, 0, -100);
                //     })
                                     
                //     $(this).removeClass('btn--outline')
                //     $(this).text('取消此配件')//按了配件之後要變可以取消，字樣變取消配件
                // }else{
                //     // console.log('shapeIndex = 1 or 2')
                //     $('.pleaseSelect').text('此車型不可搭配尾翼').css({"display": "block"})

                //     $(this).addClass('btn--outline')
                //     $('.nextStep').addClass('btn--disabled')

                //     setTimeout(function() {
                //         $('.pleaseSelect').css({"display": "none"})
                //     }, 1000);
                // }
            }else{
                contextA3.clearRect(0, 50, 400, 150);

                $(this).addClass('btn--outline')
                $(this).text('新增此配件')
            }        
        })

        // -----------------------CANVAS取得base64---------------------------
        // $('.nextStep').click(function() {  //移到Vue
        //     if (countStep % 5 == 4) {
        //         dataURL = document.querySelector('.canvas').toDataURL();
        //         dataURLA1 = document.querySelector('.canvasA1').toDataURL();
        //         dataURLA2 = document.querySelector('.canvasA2').toDataURL();
        //         dataURLA3 = document.querySelector('.canvasA3').toDataURL();
        //         // console.log(dataURL)
        //     }
        // })

        //移到Vue
        // $('.modal__close').click(() => {
        //     console.log('關掉')
        //     $('.modal').removeClass('modal-active');
        // })

        //----------------------- 點圓圈進入、退到下一步驟 -----------------------
        $('.content:nth-child(1) .circle').click(() => {
            if(countStep % 5 == 1){
                console.log('回去countStep=0') 
                countStep--

                $('.pleaseSelect').text('請先選擇車款才能進入下一步喔')
                
                $('.colorCards').css({"display":"none"})
                $('.accessoryCard').css({"display":"none"})
                $('.shapeCards').css({"display":"flex"})
                $('.shapeCard').css({"display":"block"})
                
                //去除顏色，變不能點
                $('.content:nth-child(2) .circle').removeClass('circle--able')
                $('.content:nth-child(2) .circle').removeClass('circle--active')
                
                //進度條變短
                if (docW > 1003) {
                    $('.bar-front').width(0)
                } else if (docW <= 1003) {
                    $('.bar-front').width(0)
                }
            }
        })

        $('.content:nth-child(2) .circle').click(() => {
            if(countStep % 5 == 2){
                console.log('回到countStep == 1')
                countStep--

                $('.tireCards').css({"display":"none"})
                $('.colorCards').css({"display":"flex"})
                $('.colorCard').css({"display":"block"})

                $('.content:nth-child(3) .circle').removeClass('circle--able')
                $('.content:nth-child(3) .circle').removeClass('circle--active')

                //進度條變短
                if (docW > 1003) {
                    $('.bar-front').width(240)
                } else if (docW <= 1003) {
                    $('.bar-front').width(220)
                }               
           }else if(countStep % 5 == 0 && $('.nextStep').hasClass('btn--disabled')){
                $('.pleaseSelect').css({"display": "block"})

                setTimeout(() => {
                    $('.pleaseSelect').css({"display": "none"})
                }, 1000);
           }else if(countStep % 5 == 0 && !$('.nextStep').hasClass('btn--disabled')){
                console.log('前進到countStep == 1')
                countStep++

                $('.nextStep').addClass('btn--disabled')
                    
                $('.shapeCard').css({"display": "none"})
                //進入選顏色
                $('.colorCards').css({"display": "flex"})
                $('.colorCard').css({"display": "block"})
                //提醒內容變更
                $('.pleaseSelect').text('請先選擇烤漆才能進入下一步喔')
                //進度條、圓圈變色
                $('.content:nth-child(2) .circle').addClass('circle--able')
                $('.content:nth-child(2) .circle').addClass('circle--active')
                if (docW > 1003) {
                    $('.bar-front').width(240)
                } else if (docW <= 1003) {
                    $('.bar-front').width(220)
                }
           }
        })    

        $('.content:nth-child(3) .circle').click(() => {
            if(countStep % 5 == 3){
                console.log('回到countStep == 2')
                countStep--
                
                $('.accessoryCards').css({"display":"none"})
                $('.tirerCards').css({"display":"flex"})
                $('.tireCard').css({"display":"block"})

                $('.content:nth-child(4) .circle').removeClass('circle--able')
                $('.content:nth-child(4) .circle').removeClass('circle--active')

                //進度條變短
                if (docW > 1003) {
                    $('.bar-front').width(480)
                } else if (docW <= 1003) {
                    $('.bar-front').width(440)
                }

            }else if(countStep % 5 == 1 && $('.nextStep').hasClass('btn--disabled')){
                $('.pleaseSelect').css({"display": "block"})

                setTimeout(() => {
                    $('.pleaseSelect').css({"display": "none"})
                }, 1000);
            }else if(countStep % 5 == 1 && !$('.nextStep').hasClass('btn--disabled')){
                console.log('前進到countStep == 2')
                countStep++

                $('.nextStep').addClass('btn--disabled')

                //進入選輪子
                $('.colorCard').css({"display": "none"})

                $('.tireCards').css({"display": "flex"})
                $('.tireCard').css({"display": "block"})

                //提醒內容變更
                $('.pleaseSelect').text('請先選擇輪胎才能進入下一步喔')

                //進度條、圓圈變色
                $('.content:nth-child(3) .circle').addClass('circle--able')
                $('.content:nth-child(3) .circle').addClass('circle--active')

                if (docW > 1003) {
                    $('.bar-front').width(480)
                } else if (docW <= 1003) {
                    $('.bar-front').width(440)
                }
            }
        })

        $('.content:nth-child(4) .circle').click(() => {
            if(countStep % 5 == 4){
                console.log('回到countStep == 3')
                countStep--

                $('.giveName').css({"display":"none"});
                $('.selectArea').css({"display":"flex"});
                $('.accessoryCards').css({"display":"flex"})
                $('.accessoryCard').css({"display":"block"})

                $('.content:nth-child(5) .circle').removeClass('circle--able')
                $('.content:nth-child(5) .circle').removeClass('circle--active')

                 //進度條變短
                if (docW > 1003) {
                     $('.bar-front').width(730)
                } else if (docW <= 1003) {
                     $('.bar-front').width(660)
                }

            }else if(countStep % 5 == 2 && $('.nextStep').hasClass('btn--disabled')){
                $('.pleaseSelect').css({"display": "block"})

                setTimeout(() => {
                    $('.pleaseSelect').css({"display": "none"})
                }, 1000);
            }else if(countStep % 5 == 2 && !$('.nextStep').hasClass('btn--disabled')){
                console.log('前進到countStep == 3')
                countStep++

                if(shapeIndex != 0){
                        console.log('讓尾翼不能選')
                        $('.selectA6').addClass('btn--disabled')
                        $('.selectA6').removeClass('btn--outline')
                        $('.selectA6').css({"pointer-events":"none"})
                }
                    
                $('.nextStep').addClass('btn--disabled')

                //進入選配件
                $('.tireCard').css({"display": "none"})

                //提醒內容變更
                $('.pleaseSelect').text('請先選擇配件才能進入下一步喔')
                $('.accessoryCards').css({"display": "flex"})
                $('.accessoryCard').css({"display": "block"})

                //進度條、圓圈變色
                $('.content:nth-child(4) .circle').addClass('circle--able')
                $('.content:nth-child(4) .circle').addClass('circle--active')

                if (docW > 1003) {
                    $('.bar-front').width(730)
                } else if (docW <= 1003) {
                    $('.bar-front').width(660)
                }
            }
        })

        $('.content:nth-child(5) .circle').click(() => {
            if(countStep % 5 == 3 && $('.nextStep').hasClass('btn--disabled')){
                $('.pleaseSelect').css({"display": "block"})
                            
                setTimeout(() => {
                    $('.pleaseSelect').css({"display": "none"})
                }, 1000);
            }else if(countStep % 5 == 3 && !$('.nextStep').hasClass('btn--disabled')){
                console.log('前進到countStep == 4')
                countStep++

                $('.nextStep').addClass('btn--disabled').text('完成')
                    $('.nextStep').addClass('finish')

                    $('.selectArea').css({"display": "none"})

                    $('.giveName').css({
                        "display": "flex",
                        "justify-content": "space-between"
                    })

                    //左右紐消失
                    $('.selectBtn').css({"display": "none"})

                    //提醒內容變更
                    $('.pleaseSelect').text('請先填寫完資料才能完成作品喔')

                    //進度條、圓圈變色
                    $('.content:nth-child(5) .circle').addClass('circle--able')
                    $('.content:nth-child(5) .circle').addClass('circle--active')

                    if(docW > 1003){
                        $('.bar-front').width(960) 
                    }else if(docW <= 1003){
                        $('.bar-front').width(840) 
                    }
            }
        })

        // 瀑布流樣式控制
        $('.grid').masonry({
          // options
          horizontalOrder: true,
          itemSelector: '.grid-item',
          columnWidth: 466
        });

        // $('.work:nth-child(2) .readMore').click(() =>{  //如何改成只有在該貼文有被隱藏的回覆時，打開隱藏回覆會把下面的.work推開?  //還沒改好，之後移到Vue
        //     if(count2 % 2 == 1){
        //         $('.work:nth-child(5)').animate({
        //                 top: '+=155'
        //         });
        //     }else{
        //         $('.work:nth-child(5)').animate({
        //                 top: '-=155'
        //         });
        //     }
        // })

        // $('.readMore').click(() =>{  //還沒改好，之後移到Vue
        //     if(count2 % 2 == 1){

        //         let gridH = $('.grid').height()
        //         $('.grid').height(gridH += 155)
        //     }else{

        //         let gridH = $('.grid').height()
        //         $('.grid').height(gridH -= 155)
        //     }
        // })

        // $('.work:nth-child(2) .moreReply').click(() =>{  //??還沒改好，之後移到Vue
        //     // $('.work:nth-child(5)').css({"top": += 300})
        //     if(count1 % 2 == 1){
        //         $('.work:nth-child(5)').animate({
        //                 top: '+=127'
        //         });
        //     }else{
        //         $('.work:nth-child(5)').animate({
        //                 top: '-=127'
        //         });
        //     }
        // })



        // $('.moreReply').click(() =>{ //還沒改好，之後移到Vue
        //     if(count1 % 2 == 1){
        //         let gridH = $('.grid').height()
        //         $('.grid').height(gridH += 127)
        //     }else{

        //         let gridH = $('.grid').height()
        //         $('.grid').height(gridH -= 127)
        //     }
        // })
    </script>
</body>

</html>