<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/Swiper/6.4.15/swiper-bundle.min.css' />
<link rel="stylesheet" href="./assets/css/all.css">
<link rel="stylesheet" href="./assets/css/pages/index.css">

<script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vuex/3.6.2/vuex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/Swiper/6.4.15/swiper-bundle.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/MotionPathPlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
<script src="./assets/js/utils.js"></script>

<title>index</title>
</head>

<body>
    <div id="app" v-cloak>
        <vue-header></vue-header>
        <main class="pt-25 index">
            @@include('./pages/HomePage/HomeParkingHeader.html')
            @@include('./pages/HomePage/HomeProductSection.html')
            <!-- @@include('./pages/HomePage/HomeBillBoardSection.html') -->
            <!-- @@include('./pages/HomePage/HomeHighWaySection.html') -->
            @@include('./pages/HomePage/HomeMountainSection.html')
            @@include('./pages/HomePage/HomeFactorySection.html')
            @@include('./pages/HomePage/HomeAboutSection.html')
            @@include('./pages/HomePage/HomeAddressSection.html')
            @@include('./pages/HomePage/HomeEndFooter.html')
        </main>
        @@include('./components/Footer.html')
    </div>



    @@include('./components/VueHeader.html')
    @@include('./components/PinSvg.html')
    <!-- @@include('./pages/HomePage/HomeDisplayItem.html') -->



    <!-- <script type="module">
    import {sayHi} from './assets/js/data.js';
    sayHi('index');
</script> -->

    <script src="./assets/js/mixins/productMixins.js"></script>


    <script>
        new Vue({
            el: '#app',
            store,
            mixins: [productMixins],
            data: {
                isDisplayPlay: false,
                isCarNearGirl: false,
                isCTAShow: false,
                swiperMountain: null,
            },
            computed: {
                seriesList() {
                    return this.$store.state.seriesList
                },
                memberId() {
                    return this.$store.state.memberId
                },
            },
            watch: {
                productList(list) {
                    if (list && list.length) {
                        this.handleInitMountainSwiper();
                    }
                },
            },
            methods: {
                handleGirlClick() {
                    if (this.isCarNearGirl) {
                        this.isCTAShow = true;
                        let endCar = new TimelineMax();
                        endCar.to('.factory__car', 4, {
                            x: 1920,
                            ease: Linear.easeNone,
                            delay: 3,
                            reverse: false

                        })
                    }
                },
                handleSlideToIndex(index) {
                    if (this.swiperMountain) {
                        this.swiperMountain.slideTo(index);
                    }
                },
                handleInitMountainSwiper() {
                    const indexProductList = ['2', '27', '17', '22', '28'];
                    this.showProductList = this.productList.filter(product => indexProductList.indexOf(product
                        .productId) >= 0);
                    this.$nextTick(() => {
                        this.swiperMountain = new Swiper('#swiperContainerMountain', {
                            spaceBetween: 20,
                            autoplay: {
                                delay: 2000,
                                disableOnInteraction: false
                            },
                            loop: true,
                            speed: 800,
                            effect: 'fade',
                        });

                    });

                }
            },

            mounted() {
                // --------------------------------------------swiper
                let swiperBillboard = new Swiper('#swiperContainerBillboard', {
                    spaceBetween: 20,
                    autoplay: {
                        delay: 2000,
                        disableOnInteraction: false
                    },
                    loop: true,
                    // mousewheel: true,
                    speed: 800,
                    // effect: 'fade',
                });


                // --------------------------------------------gsap
                let controller = new ScrollMagic.Controller();
                let screenX = document.body.clientWidth;

                // ----------------------parking
                let mvParking = gsap.to('.parking__car', 4, {
                    x: -screenX * .65, //5
                    y: screenX * .39, //3
                });

                new ScrollMagic.Scene({
                        triggerElement: '#triggerParking', //觸發點
                        offset: 500,
                        reverse: false
                    }).setTween(mvParking) //動畫
                    .addIndicators({
                        name: 'keyParking',
                        colorStart: '#13fe13'
                    })
                    .addTo(controller);


                // ----------------------product
                gsap.registerPlugin(MotionPathPlugin);

                let mvProduct = gsap.timeline();
                mvProduct.to('.product__car', 3.5, {
                    motionPath: {
                        path: "#productFirstPath",
                        align: "#productFirstPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                    },
                    ease: Linear.easeNone,

                }).to('.product__car', 2, {
                    motionPath: {
                        path: "#productSecondPath",
                        align: "#productSecondPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                    },
                    ease: Linear.easeNone,
                    delay: .5,
                }).to('.product__car', 6, {
                    motionPath: {
                        path: "#productEndPath",
                        align: "#productEndPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                    },
                    ease: Linear.easeNone,
                    delay: .5,
                })
                new ScrollMagic.Scene({
                        triggerElement: '#triggerProduct',
                        // reverse: false
                    }).setTween(mvProduct)
                    .addIndicators({
                        name: 'keyProduct',
                        colorStart: '#f20'

                    })
                    .addTo(controller)
                // ----------------------billboard
                let mvBillboard = gsap.to('.billboard__car', 3, {
                    x: -(screenX + 250),
                    ease: Linear.easeNone,
                });

                new ScrollMagic.Scene({
                        triggerElement: '#triggerBillboard',
                        offset: 200,
                        reverse: false
                    }).setTween(mvBillboard)
                    .addIndicators({
                        name: 'keyBillboard',
                        colorStart: '#f20'

                    })
                    .addTo(controller);

                // ----------------------mountain
                let mvMountain = gsap.to('.mountain__car', 3, {
                    x: screenX + 250,
                    ease: Linear.easeNone,
                });

                new ScrollMagic.Scene({
                        triggerElement: '#triggerMountain',
                        offset: -200,
                        reverse: false
                    }).setTween(mvMountain)
                    .addIndicators({
                        name: 'keyMountain',
                        colorStart: '#f20'

                    })
                    .addTo(controller);
                // ----------------------factory service
                let mvCustom = gsap.from(".gsap-custom", 4, {
                    scale: 0,
                    ease: Elastic.easeInOut,
                    stagger: {
                        from: "inner",
                        amount: 0.25
                    }
                });

                new ScrollMagic.Scene({
                        triggerElement: '#triggerCustom',
                        offset: -100,
                        duration: "30%",
                        // reverse: false
                    }).setTween(mvCustom)
                    .addIndicators({
                        name: 'keyCustom',
                        colorStart: '#f20'

                    })
                    .addTo(controller);


                // ----------------------factory car



                let mvFactory = gsap.timeline();
                mvFactory.to('.factory__door', 2, {
                    y: -screenX * .1,
                }).to('.factory__car', 2, {
                    motionPath: {
                        path: "#factoryRoadPath",
                        align: "#factoryRoadPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                    },
                    ease: Linear.easeNone,
                }).to('.factory__car', 4, {
                    motionPath: {
                        path: "#turnRoadPath",
                        align: "#turnRoadPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                        start: 1,
                        end: 0,
                    },
                    ease: Linear.easeNone,
                    delay: .5,
                }).to('.factory__car', 4, {
                    motionPath: {
                        path: "#endRoadPath",
                        align: "#endRoadPath",
                        alignOrigin: [0.5, .5],
                        autoRotate: -90,
                        transformOrigin: "50% 50%",
                    },
                    ease: Linear.easeNone,
                    delay: 1,
                }).to('.thumb--stop', 0, {
                    opacity: 1,
                    ease: Linear.easeNone,
                }).to('.thumb--stop', 0, {
                    opacity: 0,
                    ease: Linear.easeNone,
                    delay: 1.5,
                }).to('.factory__car', 2, {
                    xPercent: -55,
                    ease: Linear.easeNone,
                }).then(() => {
                    this.isCarNearGirl = true;
                })


                new ScrollMagic.Scene({
                        triggerElement: '#triggerFactory',
                        offset: 200,
                        // reverse: false
                    }).setTween(mvFactory)
                    .addIndicators({
                        name: 'keyFactory',
                        colorStart: '#f20'

                    })
                    .addTo(controller)

                // ----------------------delivery
                let mvDelivery = gsap.from(".gsap-delivery", 4, {
                    scale: .5,
                    cycle: {
                        y: [-50, 50]
                    },
                    ease: Elastic.easeInOut,
                    stagger: {
                        from: "inner",
                        amount: 0.25
                    }
                });
                let triggerDeliveryOffset;
                screenX > 768 ? triggerDeliveryOffset = 400 : triggerDeliveryOffset = -100;
                new ScrollMagic.Scene({
                        triggerElement: '#triggerDelivery',
                        offset: triggerDeliveryOffset,
                        duration: "30%",
                        // reverse: false,
                    }).setTween(mvDelivery)
                    .addIndicators({
                        name: 'keyDelivery',
                        colorStart: '#f20'

                    })
                    .addTo(controller);


                // ----------------------delivery
                // let mvAddress = new TimelineMax();
                // mvAddress.staggerFrom(".address__img", 4, {

                //     rotate: 10,
                //     cycle: {
                //         y: [-50, 50]
                //     },
                //     ease: Elastic.easeInOut,
                //     stagger: {
                //         from: "inner",
                //         amount: 0.25
                //     }
                // });

                // new ScrollMagic.Scene({
                //         triggerElement: '#triggerAddress',
                //         offset: -100,
                //         duration: "40%",
                //     }).setTween(mvAddress)
                //     .addIndicators({
                //         name: 'keyAddress',
                //         colorStart: '#f20'

                //     })
                //     .addTo(controller);

            }




        });
    </script>
</body>

</html>